

## CRIANDO BANCO DE DADOS DE CONFIGURAÇÃO

A Camada de Configuração precisa de um banco de dados para armazenar os dados de configuração. A configuração desses bancos de dados envolve:

- criação do banco de dados no SGBD
- realmente instalando o Configuration Server porque os scripts SQL obrigatórios são disponibilizados pela instalação
- executar os scripts SQL que criam as tabelas dos bancos de dados e as preenchem com os dados iniciais.

A criação do banco de dados geralmente é deixada para o administrador do banco de dados. Criar as tabelas e preenchê-las também pode ser tarefa de um DBA dedicado, caso em que ele precisará dos scripts SQL que são copiados para o sistema de arquivos pela instalação do Configuration Server.


Comece criando os bancos de dados de configuração no DBMS e dando um nome ao banco de dados:


- Na classe, o nome é config;

**Execute scripts SQL para criar o banco de dados:**

init_mult(inicialization) - Este script inicializa o banco de dados e cria várias tabelas que começam com cfg que conterão os dados de configuração.

![image](https://user-images.githubusercontent.com/52088444/152177942-496f64e8-9452-4836-97f9-99a037b86830.png)


Cfglocale(localization)- Este script executa a localização. Ele preenche uma tabela cfg_locale e a preenche com informações específicas de idioma ou localização, como no exemplo abaixo: English data localized to French.

![image](https://user-images.githubusercontent.com/52088444/152178501-bd912512-a86f-4403-8b74-d34d814056aa.png)

Nota: no script CfgLocale - Este script é específico para a versão de idioma do Genesys que você está implementando; ele contém informações específicas do idioma que são usadas em nossas interfaces GUI. O exemplo acima está em francês.
## ARQUIVO DE CONFIGURAÇÃO (CONFIGURANTION FILE)

O arquivo de configuração do servidor de configuração é chamado confserv.cfg em Windowns(conf-serv.conf em unix) e é criado a partir dos valores iniciais inseridos durante a instalação. Você pode modificar esse arquivo, mas é necessário reiniciar para que as alterações entrem em vigor.
**O arquivo de configuração contém cinco seções:**
- configuration server section - seção do servidor de configuração [confserv] - Esta seção controla o comportamento(bahavior) do aplicativo.

![image](https://user-images.githubusercontent.com/52088444/152193580-32ab95ba-6135-4757-8003-dba846041c6d.png)
![image](https://user-images.githubusercontent.com/52088444/152193686-2e7ad122-56e8-4d7a-944d-57f0a3b4c8a7.png)

- log section-[log] - Esta seção controla as mensagens de log do aplicativo

- HCA section - [hca] - Esta seção controla a manutenção do histórico de mudanças, usado pelo info Mart- não abordado neste curso. A HCA alinha a análise de relatórios com as alterações de configuração.

- SOAP section - [soap] - Esta seção contém parâmetros de acesso do cliente SOAP - não abordados neste curso.

- DB Server section - [dbserver] - Esta seção controla o comportamento do aplicativo.


Veja a imagem abaixo para um exemplo de como o arquivo Configure é agrupado nas diferentes seções.

**confserv.cfg**
- opções para configuration server
- a instalação solicita e define muitos desses comandos(prompts)

O nome da opção(option-name) é mostrado abaixo:

[sections-name]
option-name = value
![image](https://user-images.githubusercontent.com/52088444/152195860-a11471b9-b39d-4975-bd0a-512548f978c6.png)

**Exemplo:**
![image](https://user-images.githubusercontent.com/52088444/152196140-7600c7f7-7ebe-4963-93a5-1c3edb366341.png)

Para obter informações detalhadas, consulte o Manual de Referência de Opções de Configurações da estrutura(framework Configurations Options )

## EXECUTAR O SERVIDOR DE CONFIGURAÇÃO(RUNNING CONFIGURATION SERVER)

Existem várias maneiras de executar o Configuration Server e exemplos dessas opções são:

- Serviços do Windows - Quando você executa a instalação, o Servidor de Configuração é instalado como um Serviço do Windows. Você pode usar o Windows Service para iniciar e parar o aplicativo Configuration Server. A configuração padrão é Startup Type =Automatic, portanto, o Configuration Server iniciará a inicialização automaticamente.

- Menu Iniciar do Windows - O servidor de configuração pode ser iniciado a partir do menu Iniciar. Você deve começar com o botão Iniciar e navegar por GenesysSolutions > Framework > Multitenant Configuration Server > Start Multitenant Configurations Server.

Nota: A Opção de Menu Iniciar do Windows não é normalmente usada em um ambiente de produção. Isso ocorre porque a execução do Configuration Server a partir do menu iniciar o abre em uma janela de consulta. Embora isso possa ser útil para solucionar problemas em um ambiente de produção, não é recomendado. Clicar dentro da janela de consulta pode congelar o Servidor de Configuração. Em um ambiente de produção, o Configuration Server é melhor executado como um serviço em segundo plano.

- Linha de comando: o servidor de configuração pode ser iniciado a partir da linha de comando abrindo uma janela de comando e digitando os parâmetros da linha de comando para iniciar o servidor de configuração.

![image](https://user-images.githubusercontent.com/52088444/152199081-14c79dd1-1121-43a8-a0c9-371fb84fed40.png)

## OPTIONAL COMMAND LINE  PARAMETERS(PARÂMETROS DE LINHA DE COMANDO OPCIONAIS)

O Configuration Server não requer nenhum dos parâmetros de linha de comando normalmente necessários para outros componentes do Genesys Server. No entanto, você pode adicionar alguns parâmetros de linha de comando especiais específicos ao Configuration Server para executar algumas tarefas especiais.


**Nota: Você pode usar confserv/? para obter informações sobre parâmetros de linha de comando (confserv.con no UNIX ou confserv.cfg no Windows)**

**Normal mode:**

*- c*

O Servidor de Configurações(Configuration Server) lê suas configurações de um arquivo de configuração(configurations file) com o nome especificado.Se você definir este parâmetro, seu valor substituirá o nome padrão do arquivo de configuração (confserv.conf no Unix ou confserv.cfg no Windows).

*-checkdb*

Uma instância do Configuration Server inicia , verifica a integridade do objeto de banco de dados e termina; todas as mensagens de logs são gravadas na saída de log.

*-checkerrors*

Uma instância do Configuration Server é iniciada, verifica a integridade do objeto do banco de dados e encerra as mensagens de log de erros são gravadas na saída do log.

![image](https://user-images.githubusercontent.com/52088444/152201557-de324a53-5aeb-4c37-ab1c-8c6c5a4924be.png)


Parâmetros de linha de comando adicionais:

Você também pode usar os seguintes parâmetros de linha de comando ao iniciar o Servidor de Configuração:

*-s*

O Configuration Server lê suas configurações de uma seção de configuração com o nome especificado. A seção deve ser configurada dentro do arquivo de configuração do Configuration Server;o nome da seção deve ser igual ao nome do aplicativo do servidor de configuração configurado no banco de dados de configuração. Use este parâmetro para iniciar um servidor de configuração de backup.

*-p*

Força uma instância do Configuration Server a iniciar, criptografar a senha do banco de dados no arquivo de configuração e encerrar. Consulte Criptografando a senha do banco de dados de configurações.

*-keys{<encryption file name><decryption file name>}*

Força o Configuration Server a usar um algoritmo de criptografia assimétrica para criptografar e descriptografar a senha do banco de dados de configuração. Se os subparâmetros forem especificados, a chave de criptografia armazenada no <nome do arquivo de criptografia> e a chave de descriptografia (privada) no <nome do arquivo de descriptografia>. Se não for especificado por este parâmetro, as chaves são armazenadas em enc.pem e dec.pem no diretório em que o Configurations Server está instalado. Consulte Criptografia da senha do banco de dados de configuração para obter mais informações sobre como criptografar a senha do banco de dados de configuração.

*-cfglib_port*

O Configuration Server abre a porta de licença especificada na linha de comando. A porta é aberta no modo não seguro. Essa porta não é gravada no objeto de aplicativo do servidor de configuração e não sobrevive a uma reinicialização do servidor de configuração.
Não use esta opção como parte da inicialização normal. Use-o apenas como último recurso quando as portas seguras regulares não puderem ser acessadas devido a um problema de configuração, como certificados de segurança incorretos ou expirados, ou quando uma porta duplicada (não necessariamente segura) for especificada na configuração e, portanto, não puder ser aberta.

**O servidor de configuração deve ser interrompido durante o processo de criptografia**


## Modo utilitário de Licença(License Utility Mode)

O Modo Utilitário de Licença é um modo obrigatório que é executado a partir da linha de comando.

Como visto no exemplo, você ainda usa confserv(que é o executável), mas está usando o parâmetro -license e <filename> que indica o caminho para o arquivo de licença que contém os itens vendáveis
![image](https://user-images.githubusercontent.com/52088444/152206627-323f3d78-d9fd-4335-8092-c63141969916.png)

As informações do item vendável são carregadas na Camada de Configuração e disponibilizadas para licenciar o Reporting Manager. Permite também as verificações de licenças exigidas pelo servidor de configuração para a instalação do Genesys Plataform.

Para executar o License Utility Mode, execute o seguinte comando na linha de comando, conforme apropriado:

![image](https://user-images.githubusercontent.com/52088444/152207327-30c3ca88-c279-4eee-af0d-c5bb9b6d9180.png)


depois disso, você pode iniciar o Configuration Server

## Encrypting DatabasePasword Mode

Você pode usar o Configuration Server para criptografar sua senha para acessar o banco de dados de configuração para que ela não apareça explicitamente no arquivo confserv.cfg.


Você precisa editar o arquivo de configuração (confserv.cfg) da seguinte forma:

![image](https://user-images.githubusercontent.com/52088444/152207880-900edc39-5fee-4484-9c00-e2bf3e40858d.png)

![image](https://user-images.githubusercontent.com/52088444/152207971-f997aba0-dfc6-423f-b728-4264c8d57bba.png)

após a senha ser criptografada, o Configuration Server descriptografa o valor ao ler seu arquivo de configuração nas inicializações subsequentes e acessa o banco de dados de configuração usando o valor descriptografado.

para fazer isso, execute o seguinte comando na linha de comando:

![image](https://user-images.githubusercontent.com/52088444/152208384-ae25d3d4-3247-4982-96d6-1746f0d60e21.png)

Ele irá criptografar a senha do banco de dados no arquivo de configuração: uma instância é iniciada, grava no arquivo de configuração uma versão criptografada da senha usada para obter acesso ao banco de dados de configuração e sai.

